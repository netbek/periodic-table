{%- macro categoryLegend(elements, categories) %}
<table class="nb-periodic-table-category-legend">
  <caption>Categories</caption>
  <tbody>
  {%- for elementCategory, items in elements | groupby("category") %}
    {%- if loop.index % 2 === 1 %}
      {%- if loop.first === false %}
    </tr>
      {%- endif %}
    <tr class="nb-periodic-table-category-legend-row">
      {%- endif %}

    {%- for category in categories %}
      {%- if category.id === elementCategory %}
      <td class="nb-periodic-table-category-legend-cell">
        <span class="nb-periodic-table-category-legend-item" data-category="{{ category.id }}">
          <span class="nb-periodic-table-category-legend-item__swatch"></span>
          <span class="nb-periodic-table-category-legend-item__label">{{ category.name }}</span>
        </span>
      </td>
      {%- endif %}
    {%- endfor %}

    {%- if loop.last %}
      {%- if loop.index % 2 === 1 %}
      <td class="nb-periodic-table-category-legend-cell"></td>
      {%- endif %}
    </tr>
    {%- endif %}
  {%- endfor %}
  </tbody>
</table>
{%- endmacro %}
